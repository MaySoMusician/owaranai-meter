(function(t){function e(e){for(var r,i,u=e[0],s=e[1],c=e[2],m=0,d=[];m<u.length;m++)i=u[m],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(d.length)d.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,u=1;u<n.length;u++){var s=n[u];0!==a[s]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var l=s;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";n("85ec")},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),a=n("5f5b"),o=(n("e008"),n("de82"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main-container",attrs:{id:"app"}},[n("router-view")],1)}),i=[],u=(n("034f"),n("2877")),s={},c=Object(u["a"])(s,o,i,!1,null,null,null),l=c.exports,m=n("8c4f"),d=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"py-5 text-center"},[r("b-container",{staticClass:"text-center",attrs:{id:"header"}},[r("b-row",[r("b-col",{attrs:{cols:"3"}}),r("b-col",{attrs:{cols:"6"}},[r("img",{attrs:{src:n("a23e")}})]),r("b-col",{attrs:{cols:"3"}})],1)],1),r("b-container",{attrs:{id:"Description"}},[r("p",{staticClass:"lead"},[t._v("“女性が多い会議”は本当に“時間がかかる”のか？")]),r("p",[t._v("会議中の発言時間を計測・可視化します。")])]),r("b-container",{attrs:{id:"Description"}},[r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("p",[t._v("みんなの会議の集計結果")])]),r("b-col",{attrs:{cols:"6"}},[0!==t.totalMeetingNum?r("div",[r("svg",{attrs:{id:"chart",width:"300",height:"300"}},[r("g",{attrs:{id:"inner"}})])]):t._e()]),r("b-col",{attrs:{cols:"6"}},[r("h4",[t._v("これまでの集計")]),r("p",[t._v(t._s(t.totalMeetingNum)+"会議")]),r("h4",[t._v("参加人数")]),r("p",[t._v(t._s(t.totalParticipants)+"人")]),r("h4",[t._v("参加者の構成")]),0!==t.totalMeetingNum?r("div",[r("svg",{attrs:{id:"barChart"}})]):t._e()])],1)],1),r("hr"),r("b-container",{attrs:{id:"meter"}},[r("b-row",[r("b-col",{attrs:{cols:"12"}},[r("h3",[t._v("会議中の発言時間を計測・可視化します。")]),r("p",[t._v("男性・女性それぞれのスタート、ストップを押して、会議中の発言時間を計測してください。")])])],1),r("b-row",[r("b-col",{attrs:{cols:"3"}}),r("b-col",{attrs:{cols:"6"}},[r("p",[t._v("統計情報の収集のため、計測結果をサーバに送信します。（会議名は送信されません）。計測ボタンを押すと同意したことになります。")]),r("b-button",{attrs:{href:"/try_meter",block:"",variant:"primary"}},[t._v("計測する")])],1),r("b-col",{attrs:{cols:"3"}})],1)],1),r("hr")],1)},f=[],b=(n("13d5"),n("bc3a")),h=n.n(b),p=h.a.create({baseURL:Object({NODE_ENV:"production",BASE_URL:"/"}).VUE_APP_ROOT_API,timeout:5e3,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"}}),g=p,v=n("5698"),w={name:"Total",data:function(){return{totalMeetingNum:0,totalParticipants:0,sumDurationMen:0,sumDurationWomen:0,sumNumberMen:0,sumNumberWomen:0}},mounted:function(){this.getDataAndDrawChart()},methods:{getDataAndDrawChart:function(){var t=this;g({method:"get",url:"/meetings/"}).then((function(e){t.totalMeetingNum=e.data.length,t.sumDurationMen=e.data.reduce((function(t,e){return t+e.duration_men}),0),t.sumDurationWomen=e.data.reduce((function(t,e){return t+e.duration_women}),0),t.sumNumberMen=e.data.reduce((function(t,e){return t+e.num_men}),0),t.sumNumberWomen=e.data.reduce((function(t,e){return t+e.num_women}),0),t.totalParticipants=t.sumNumberMen+t.sumNumberWomen})).then((function(){t.drawChart(),t.drawBarChart()})).catch((function(t){console.error(t)}))},drawChart:function(){var t=[{label:"men",value:this.sumDurationMen},{label:"women",value:this.sumDurationWomen}],e=v["f"]("#chart"),n=e.attr("width"),r=e.attr("height"),a=Math.min(n,r)/2,o=v["f"]("#inner").attr("transform","translate("+n/2+","+r/2+")"),i=v["e"]().range(["#04c4b4","#ff8355"]),u=v["c"]().value((function(t){return t.value})).sort(null),s=v["a"]().innerRadius(0).outerRadius(a),c=o.selectAll("arc").data(u(t)).enter().append("g").attr("class","arc");c.append("path").attr("fill",(function(t,e){return i(e)})).transition().delay((function(t,e){return 800*e})).duration(1e3).attrTween("d",(function(t){var e=v["b"](t.startAngle+.1,t.endAngle);return function(n){return t.endAngle=e(n),s(t)}}));var l=v["a"]().outerRadius(a-60).innerRadius(a-60);c.append("text").attr("fill","black").attr("transform",(function(t){return"translate("+l.centroid(t)+")"})).attr("dy","5px").attr("text-anchor","middle").text((function(t){return t.data.label}))},drawBarChart:function(){var t=[{label:"men",num:this.sumNumberMen,startPos:0},{label:"women",num:this.sumNumberWomen,startPos:this.sumNumberMen}],e={margin:{top:20,right:0,bottom:20,left:0},width:300,height:100,barHeight:50},n=e.margin,r=e.width,a=e.height,o=e.barHeight,i=r-n.left-n.right,u=a-n.top-n.bottom,s=o/2,c=v["e"]().range(["#04c4b4","#ff8355"]),l=v["g"](t,(function(t){return t.num})),m=v["d"]().domain([0,l]).range([0,i]),d=v["f"]("#barChart").attr("width",r).attr("height",a).append("g");d.selectAll("rect").data(t).enter().append("rect").attr("class","rect-stacked").attr("x",(function(t){return m(t.startPos)})).attr("y",u/2-s).attr("height",o).attr("width",(function(t){return m(t.num)})).attr("fill",(function(t,e){return c(e)})),d.selectAll(".text-value").data(t).enter().append("text").attr("class","text-value").attr("text-anchor","middle").attr("x",(function(t){return m(t.startPos)+m(t.num)/2})).attr("y",u/2+5).text((function(t){return t.num})),d.selectAll(".text-label").data(t).enter().append("text").attr("class","text-label").attr("text-anchor","middle").attr("x",(function(t){return m(t.startPos)+m(t.num)/2})).attr("y",u/2+1.1*s+20).attr("fill",(function(t,e){return c(e)})).text((function(t){return t.label}))}}},_=w,M=Object(u["a"])(_,d,f,!1,null,null,null),T=M.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-container",[n("b-row",[n("b-col",[n("b-form-input",{model:{value:t.meetingName,callback:function(e){t.meetingName=e},expression:"meetingName"}})],1),n("b-col",[t._v(" の会議 ")])],1),n("b-row",{staticClass:"mb-4"},[n("b-col",[n("b-row",[n("b-col",[n("b-form-input",{attrs:{min:"0",type:"number"},model:{value:t.number.men,callback:function(e){t.$set(t.number,"men",t._n(e))},expression:"number.men"}})],1),n("b-col",[t._v(" 人 ")])],1),n("p",[t._v(" "+t._s(t.hours("men"))+" : "+t._s(t._f("zeroPad")(t.minutes("men")))+" : "+t._s(t._f("zeroPad")(t.seconds("men")))+" ")]),t.isRunning.men?n("b-avatar",{attrs:{button:"",size:"72px",disabled:!t.inMeeting||!t.isRunning.men},on:{click:function(e){return t.stopTimer("men")}}}):n("b-avatar",{attrs:{button:"",size:"72px",disabled:!t.inMeeting||t.isRunning.men},on:{click:function(e){return t.startTimer("men")}}})],1),n("b-col",[n("b-row",[n("b-col",[n("b-form-input",{attrs:{min:"0",type:"number"},model:{value:t.number.women,callback:function(e){t.$set(t.number,"women",t._n(e))},expression:"number.women"}})],1),n("b-col",[t._v(" 人 ")])],1),n("p",[t._v(" "+t._s(t.hours("women"))+" : "+t._s(t._f("zeroPad")(t.minutes("women")))+" : "+t._s(t._f("zeroPad")(t.seconds("women")))+" ")]),t.isRunning.women?n("b-avatar",{attrs:{button:"",size:"72px",disabled:!t.inMeeting||!t.isRunning.women},on:{click:function(e){return t.stopTimer("women")}}}):n("b-avatar",{attrs:{button:"",size:"72px",disabled:!t.inMeeting||t.isRunning.women},on:{click:function(e){return t.startTimer("women")}}})],1)],1),t.inMeeting?n("b-button",{attrs:{block:"",variant:"secondary"},on:{click:t.submitSave}},[t._v("会議STOP")]):n("b-button",{attrs:{block:"",variant:"primary"},on:{click:function(e){t.inMeeting=!0}}},[t._v("会議START")]),n("b-button",{attrs:{block:"",variant:"secondary"},on:{click:t.clearAll}},[t._v("CANCEL")]),t.isDone?n("b-button",{attrs:{block:"",variant:"outline-primary"},on:{click:function(e){t.showModal=!0}}},[t._v("結果を見る")]):t._e()],1),n("b-modal",{attrs:{centered:""},on:{shown:t.drawChart,ok:t.downloadImage},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[n("div",{attrs:{id:"result"}},[n("h2",[t._v(t._s(""===t.meetingName?"あなた":t.meetingName)+"の会議")]),n("b-row",[n("b-col",[t._v(" 女性 "+t._s(t.$store.state.meetingData.num_women)+"人 ")]),n("b-col",[t._v(" 男性 "+t._s(t.$store.state.meetingData.num_men)+"人 ")])],1),n("svg",{attrs:{id:"chart",width:"300",height:"300"}},[n("g",{attrs:{id:"inner"}})])],1)])],1)},y=[],D=(n("d3b7"),n("25f0"),n("3ca3"),n("4d90"),n("ddb0"),n("2b3d"),n("c0e9")),R=n.n(D),k={name:"TryMeter",data:function(){return{meetingName:"",number:{men:0,women:0},animateFrame:{men:0,women:0},nowTime:{men:0,women:0},diffTime:{men:0,women:0},startTime:{men:0,women:0},isRunning:{men:!1,women:!1},inMeeting:!1,isDone:!1,showModal:!1}},computed:{hours:function(){return function(t){return Math.floor(this.diffTime[t]/1e3/60/60)}},minutes:function(){return function(t){return Math.floor(this.diffTime[t]/1e3/60)%60}},seconds:function(){return function(t){return Math.floor(this.diffTime[t]/1e3)%60}},duration:function(){return function(t){return Math.floor(this.diffTime[t]/1e3)}}},filters:{zeroPad:function(t,e){var n="undefined"!==typeof e?e:2;return t.toString().padStart(n,"0")}},methods:{setSubtractStartTime:function(t,e){var n="undefined"!==typeof t?t:0;this.startTime[e]=Math.floor(performance.now()-n)},startTimer:function(t){var e=this;e.setSubtractStartTime(e.diffTime[t],t),function n(){e.nowTime[t]=Math.floor(performance.now()),e.diffTime[t]=e.nowTime[t]-e.startTime[t],e.animateFrame[t]=requestAnimationFrame(n)}(),e.isRunning[t]=!0},stopTimer:function(t){this.isRunning[t]=!1,cancelAnimationFrame(this.animateFrame[t])},clearAll:function(){this.inMeeting=!1,this.isDone=!1,this.meetingName="",this.number.men=0,this.number.women=0,this.startTime.men=0,this.startTime.women=0,this.nowTime.men=0,this.nowTime.women=0,this.diffTime.men=0,this.diffTime.women=0,this.stopTimer("men"),this.stopTimer("women"),this.animateFrame.men=0,this.animateFrame.women=0},submitSave:function(){var t=this;g({method:"post",url:"/meetings/",data:{num_men:this.number.men,num_women:this.number.women,duration_men:this.duration("men"),duration_women:this.duration("women"),is_done:!0}}).then((function(e){t.$store.dispatch("setData",e.data),t.showModal=!0,t.isDone=!0})).catch((function(t){console.error(t)}))},drawChart:function(){var t=[{label:"men",value:this.$store.state.meetingData.duration_men},{label:"women",value:this.$store.state.meetingData.duration_women}],e=v["f"]("#chart"),n=e.attr("width"),r=e.attr("height"),a=Math.min(n,r)/2,o=v["f"]("#inner").attr("transform","translate("+n/2+","+r/2+")"),i=v["e"]().range(["#04c4b4","#ff8355"]),u=v["c"]().value((function(t){return t.value})).sort(null),s=v["a"]().innerRadius(0).outerRadius(a),c=o.selectAll("arc").data(u(t)).enter().append("g").attr("class","arc");c.append("path").attr("fill",(function(t,e){return i(e)})).transition().delay((function(t,e){return 800*e})).duration(1e3).attrTween("d",(function(t){var e=v["b"](t.startAngle+.1,t.endAngle);return function(n){return t.endAngle=e(n),s(t)}}));var l=v["a"]().outerRadius(a-60).innerRadius(a-60);c.append("text").attr("fill","black").attr("transform",(function(t){return"translate("+l.centroid(t)+")"})).attr("dy","5px").attr("text-anchor","middle").text((function(t){return t.data.label+":"+Math.floor(t.data.value/60)%60+"分"}))},downloadImage:function(){R()(document.querySelector("#result")).then((function(t){t.toBlob((function(t){var e=URL.createObjectURL(t),n=document.createElement("a");document.body.appendChild(n),n.download="owaranai-meter.png",n.href=e,n.click(),n.remove(),setTimeout((function(){URL.revokeObjectURL(e)}),1e4)}),"image/png")}))}}},N=k,P=Object(u["a"])(N,x,y,!1,null,null,null),A=P.exports;r["default"].use(m["a"]);var O=new m["a"]({mode:"history",routes:[{path:"/",component:T},{path:"/try_meter",component:A},{path:"*",redirect:"/"}]}),C=O,S=n("2f62");r["default"].use(S["a"]);var j=new S["a"].Store({state:{meetingData:{}},mutations:{setMeetingData:function(t,e){t.meetingData=e}},actions:{setData:function(t,e){var n=t.commit;n("setMeetingData",e)}}}),$=j;r["default"].config.productionTip=!0,r["default"].use(a["a"]),new r["default"]({router:C,store:$,render:function(t){return t(l)}}).$mount("#app")},"85ec":function(t,e,n){},a23e:function(t,e,n){t.exports=n.p+"img/meter_logo-large.3512c1c6.svg"},de82:function(t,e,n){},e008:function(t,e,n){}});
//# sourceMappingURL=app.278e76fa.js.map